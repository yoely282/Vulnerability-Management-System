import requests

nessus_url = "https://your-nessus-server:8834"
access_key = "your-access-key"
secret_key = "your-secret-key"

headers = {
    "X-ApiKeys": f"accessKey={access_key}; secretKey={secret_key}"
}

def get_scans():
    response = requests.get(f"{nessus_url}/scans", headers=headers)
    scans = response.json()["scans"]
    return scans

def get_scan_results(scan_id):
    response = requests.get(f"{nessus_url}/scans/{scan_id}", headers=headers)
    scan_results = response.json()
    return scan_results


print(get_scans())