# Vulnerability Management System

## Overview
The Vulnerability Management System is designed to scan networks for vulnerabilities, aggregate scan results, and generate comprehensive reports. This system supports importing scan data from various popular vulnerability scanners, standardizing the results into a consistent JSON format for easier analysis and reporting.

## Features
- Integration with popular vulnerability scanners (e.g., Nessus, OpenVAS)
- Aggregation of scan results from multiple sources
- Storage of scan results in MongoDB
- Web dashboard to view and analyze vulnerabilities
- Detailed reports in JSON format

## Table of Contents
- [Overview](#overview)
- [Features](#features)
- [Setup](#setup)
- [Usage](#usage)
- [Scanner Integration](#scanner-integration)
- [Web Dashboard](#web-dashboard)
- [Contributing](#contributing)
- [License](#license)

## Setup
1. **Clone the repository:**
   ```sh
   git clone https://github.com/yoely282/vulnerability-management-system.git
   cd vulnerability-management-system


2. **Install dependencies:**
pip install -r requirements.txt

3. **Set up MongoDB:**
Ensure you have MongoDB installed and running. Configure the connection settings in your application.

4. **Run the application:**
python app.py

Usage

1. **Run scans:**
Integrate with the desired vulnerability scanners and fetch scan results using the provided scripts.

2. **View results:**
Access the web dashboard at http://127.0.0.1:5000 to view aggregated scan results and detailed vulnerabilities.

## Scanner Integration

## Objective

Integrate with popular vulnerability scanners (e.g., Nessus, OpenVAS) to import scan results.

**Steps**
1. Research Scanner APIs:

Study the APIs of the chosen vulnerability scanners. For example, Nessus provides a REST API, and OpenVAS uses an XML-based protocol called OSP (Open Scanner Protocol).
2. Authentication:

Set up authentication mechanisms to securely connect to the scanners' APIs.

3. Data Extraction:

Write scripts or services to fetch scan results. Use API endpoints to request scan data and handle responses.


## Example Integration with Nessus

1. Configure Nessus API credentials in get_scan_data.py:

nessus_url = "https://localhost:8834"
access_key = "your_access_key"
secret_key = "your_secret_key"

2. Fetch and normalize scan data:

from get_scan_data import get_scans, get_scan_results, normalize_scan_data, aggregate_scan_results
scans = aggregate_scan_results()

3. Store data in MongoDB:

from store_scan_data import insert_scan
for scan in scans:
    insert_scan(scan)

## Web Dashboard
## Overview

The web dashboard provides a user-friendly interface to view and analyze vulnerability scan results.

## Components
**Dashboard Page:** Displays an overview of all scans.
**Scan Details:**  Detailed view of each scan, including vulnerabilities.

## Technologies Used
Flask: For the web framework.
Bootstrap: For responsive design and styling.
jQuery: For AJAX requests to fetch scan data.



## Example Dashboard

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Vulnerability Management Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            margin-top: 50px;
        }
        .card {
            margin-bottom: 20px;
        }
        .card-header {
            background-color: #007bff;
            color: white;
        }
        .vuln-item {
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-5 text-center">Vulnerability Management Dashboard</h1>
        <div id="scans"></div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        $(document).ready(function() {
            $.getJSON('/scans', function(data) {
                var scansHtml = '';
                data.forEach(function(scan) {
                    scansHtml += `
                        <div class="card">
                            <div class="card-header">
                                <h3>${scan.name}</h3>
                            </div>
                            <div class="card-body">
                                <p><strong>Scan ID:</strong> ${scan.scan_id}</p>
                                <p><strong>Target:</strong> ${scan.target}</p>
                                <p><strong>Status:</strong> ${scan.status}</p>
                                <p><strong>Host Count:</strong> ${scan.hostcount}</p>
                                <h4>Vulnerabilities</h4>
                                <ul class="list-group">
                                    ${scan.vulnerabilities.map(vuln => `
                                        <li class="list-group-item vuln-item">
                                            <span>${vuln.plugin_name}</span>
                                            <span class="badge badge-${vuln.severity > 7 ? 'danger' : vuln.severity > 4 ? 'warning' : 'secondary'}">${vuln.severity}</span>
                                        </li>`).join('')}
                                </ul>
                            </div>
                        </div>`;
                });
                $('#scans').html(scansHtml);
            });
        });
    </script>
</body>
</html>



## Contributing

1. Fork the repository.
2. Create a new branch:
git checkout -b feature-branch

3. Make your changes and commit them:
git commit -m 'Add some feature'

4. Push to the branch:
git push origin feature-branch

5. Submit a pull request.

## License
This project is licensed under the MIT License - see the LICENSE file for details.